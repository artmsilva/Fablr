#!/usr/bin/env node
import fs from 'fs/promises';
import path from 'path';

async function main() {
  const storiesDir = path.resolve('./stories');
  const files = await fs.readdir(storiesDir);
  const imports = files.filter(f => f.endsWith('.stories.js')).map(f => `import './${f}';`).join('\n');
  const out = `// This file is generated by scripts/generate-stories-index.mjs\n// Do not edit by hand. Run node scripts/generate-stories-index.mjs to regenerate.\n${imports}\n\nexport const storiesRegistry = window.__FABLR_STORIES__ || [];\n`;
  await fs.writeFile(path.join(storiesDir, 'index.js'), out, 'utf8');
  console.log('stories/index.js generated');
}

main().catch(err => { console.error(err); process.exit(1); });